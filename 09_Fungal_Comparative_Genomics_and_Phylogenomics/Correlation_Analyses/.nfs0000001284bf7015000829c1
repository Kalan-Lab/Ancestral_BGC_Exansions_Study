library(phylolm)
library(ape)

tree <- read.tree("Fungi_Wide_Tree_with_Outgroups.tre")
dat.full <- read.table("Phylogenetic_Regression_Input.txt", header=T, sep='\t')
# name    gca     bgcome_size     genome_size     cazy_count      protein_count
  
tree <- chronos(tree)
rownames(dat.full) <- dat.full$GCA_Name

trait_info = dat.full$bgcome_size/1000000
names(trait_info) <- dat.full$name

pred_info = dat.full$genome_size/1000000
names(pred_info) <- dat.full$name

dat = data.frame(trait=trait_info,pred=pred_info)
fit = phylolm(trait~pred,data=dat,phy=tree, model="lambda")
summary(fit)
